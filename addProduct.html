<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <title>Trabajo intermedio frontend</title>
</head>
<body>
  
    <div class="container">

        <header>
            <h1 class="text-center mt-2 mb-2">Tienda de Productos y Categorias</h1>
        </header>
        
        
        <hr>
        <h2 class="text-center">Agregar Productos</h2>
        <div class="row">
            <div class="col-12 col-lg-8 col-md-8">
                <form  id="addProduct">
                    <div class="form-group">

                        <!--imagen-->
                        <label for="imagen">Imagen del producto</label>
                        <input type="file" id="file" accept="image/*" onchange="mostrar()"/>
                        <!--id-->
                      <label for="id">ID del producto</label>
                      <input type="number" class="form-control mt-3 mb-4" id="id" name="id" placeholder="Introduce el id del producto" required>

                      <!--descripcion-->
                      <label for="descripcion">Descripción</label>
                      <input type="text" class="form-control mt-3 mb-4" id="descripcion" name="descripcion" placeholder="Introduce la descripción del producto" required>
                      
                      <!--precio-->
                      <label for="precio">Precio</label>
                      <input type="number" class="form-control mt-3 mb-4" id="precio" name="precio" placeholder="Introduce el precio" required>

                      <!--Unidades-->
                      <label for="unidades">Nº de Unidades</label>
                      <input type="number" class="form-control mt-3 mb-4" id="unidades" name="unidades" placeholder="Introduce las unidades del producto" required>

                      <!--categoria-->
                      <label for="categoria">Categoria</label>
                      <input type="text" class="form-control mt-3 mb-4" id="categoria" name="categoria" placeholder="Introduce la categoria del producto" required>
                    </div>
                    
                    <input type="button" value="Agregar Producto" onclick="agregarProducto()"><br>
                    <button onclick="location.href='http://127.0.0.1:5500/index.html';" type="button" class="mt-3 btn btn-success">Volver</button>
                  </form>
            </div>
           
        </div>
    </div>
    
    <script>
var imagen = null;
function mostrar(){
            var archivo = document.getElementById("file").files[0];
            var reader = new FileReader();
            if (file) {
                reader.readAsDataURL(archivo );
                reader.onloadend = function () {
                    imagen = reader.result;
                }
            }
        }
      
      function agregarProducto(){

        


            const id = parseInt(document.getElementById('id').value);
            const descripcion = document.getElementById('descripcion').value;
            const precio =  parseInt(document.getElementById('precio').value);
            const unidades = parseInt(document.getElementById('unidades').value);
            const categoria = document.getElementById('categoria').value;

            if(exiteId(id)){
                alert("El producto con id " + id + " ya está en nuestra base de datos no puede añadirlo.");
            }else if(!exiteCategoria(categoria)){
                alert("La categoria " + categoria + " no exite en nuestra base de datos no puede añadir un producto de una categoria que no existe.");
            }else{
                const producto = {
                id,descripcion,precio,unidades,categoria,imagen
                }
                baseDeDatos.push(producto);
                localStorage.setItem("productos",JSON.stringify(baseDeDatos));
                //console.log(JSON.parse(localStorage.getItem("categorias")));

            }
           

            
            
           
           //console.log(categorias);
           
       }


    </script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/scripts.js"></script>
    
    
   
</body>
</html>